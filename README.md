# Система моделирования производственной линии

Инструмент для решения задачи распределения сотрудников между производственными центрами.

## Требования

- Java 11 или выше
- Maven 3.6 или выше

## Сборка проекта
bash
mvn clean package

## Запуск

bash
java -jar target/production-simulation-1.0-SNAPSHOT.jar input.xlsx output.csv

где:
- `input.xlsx` - входной Excel файл с описанием производственной линии
- `output.csv` - выходной CSV файл с результатами симуляции

## Формат входного файла

Excel файл должен содержать три листа:

1. Лист 1: Производственные центры
   - Название центра
   - Время обработки (в минутах)
   - Максимальное количество рабочих

2. Лист 2: Связи между центрами
   - От какого центра
   - К какому центру

3. Лист 3: Начальные данные
   - Общее количество рабочих
   - Название начального центра
   - Количество деталей

## Формат выходного файла

CSV файл содержит следующие колонки:
- Time - время в минутах
- ProductionCenter - название производственного центра
- WorkersCount - количество работающих сотрудников
- BufferCount - количество деталей в буфере

## Алгоритм оптимизации распределения рабочих

Система использует динамический алгоритм распределения рабочих между производственными центрами для достижения максимальной эффективности производства.

### Принцип работы алгоритма

1. **Расчет приоритетов**
   - Для каждого производственного центра вычисляется приоритет по формуле:
     ```
     Приоритет = Размер буфера × Время обработки детали
     ```
   - Это позволяет отдавать предпочтение центрам с большим количеством ожидающих деталей и длительным временем обработки

2. **Сортировка центров**
   - Производственные центры сортируются по убыванию приоритета
   - Центры с высшим приоритетом получают рабочих в первую очередь

3. **Распределение рабочих**
   - Для каждого центра определяется оптимальное количество рабочих:
     ```
     Оптимальное количество = min(
         Максимальное количество рабочих для центра,
         Количество деталей в буфере,
         Доступное количество рабочих
     )
     ```
   - Рабочие назначаются последовательно, начиная с центра с наивысшим приоритетом

4. **Динамическое перераспределение**
   - На каждом шаге симуляции (каждую минуту) происходит перерасчет приоритетов
   - Рабочие могут быть перемещены между центрами при изменении приоритетов
   - Перемещение происходит только после завершения обработки текущей детали

### Пример работы

Рассмотрим ситуацию с тремя центрами:

Центр 1:
Буфер: 10 деталей
Время обработки: 2 мин
Приоритет: 10 × 2 = 20

Центр 2:
Буфер: 5 деталей
Время обработки: 3 мин
Приоритет: 5 × 3 = 15

Центр 3:
Буфер: 2 детали
Время обработки: 1 мин
Приоритет: 2 × 1 = 2

При наличии 5 рабочих, они будут распределены следующим образом:
1. Центр 1 получит 3 рабочих (высший приоритет)
2. Центр 2 получит 2 рабочих (средний приоритет)
3. Центр 3 не получит рабочих на данном этапе

### Особенности и преимущества

1. **Адаптивность**
   - Алгоритм автоматически адаптируется к изменениям в производственной линии
   - Учитывает как текущую загрузку, так и время обработки

2. **Эффективность**
   - Минимизирует простои рабочих
   - Предотвращает образование узких мест в производстве

3. **Масштабируемость**
   - Работает эффективно как с малым, так и с большим количеством центров
   - Легко адаптируется к изменению количества рабочих

4. **Предсказуемость**
   - Четкие правила распределения обеспечивают предсказуемое поведение системы
   - Легко отслеживать и анализировать эффективность распределения

